import sys
#sys.path.append("flow_class")
from flow_class import flow_classification
import unittest
import geopandas as gpd
import pandas as pd

class test_flowclass(unittest.TestCase):

    def test_flowclass(self):
        print("Started tests")

        df2 = pd.DataFrame(
                {
            "index": [0,1,2,3],
            "WBID": ["AZ15040004-036B", "AZ15070103-090", "AZ15020005-018", "AZ15050203-006"],
            "geometry": ["MULTILINESTRING((655758.2795000002 3660253.021400001, 655749.0778000001 3660300.8320000004, 655710.8260000004 3660310.4054000005, 655667.8926999997 3660294.5067, 655629.2379000001 3660329.4573, 655607.4277999997 3660425.6603999995, 655586.2912999997 3660478.679199999, 655532.0976 3660533.7314, 655485.2806000002 3660604.1324000005, 655361.2921000002 3660736.8527000006, 655299.5915999999 3660784.1787, 655207.4490999999 3660828.4793, 655122.6560000004 3660890.6866999995, 655052.9508999996 3660963.2707, 655000.5913000004 3661064.0636, 654989.3279999997 3661135.036699999, 654971.1187000005 3661162.6827000007, 654857.5689000003 3661277.7990000006, 654791.0310000004 3661309.7831999995, 654645.3112000003 3661533.6229999997, 654580.4050000003 3661624.0754000004, 654503.6217999998 3661660.994000001, 654413.6699000001 3661728.197899999, 654262.7995999996 3661791.9214999992, 654170.5119000003 3661846.373299999, 654089.0350000001 3661857.8232000005, 654055.8291999996 3661870.0108000003, 654022.3438999997 3661899.976399999, 653978.0366000002 3661972.9667000007, 653939.4342999998 3662005.3882, 653891.057 3662012.2656999994, 653855.0736999996 3662039.6491, 653826.4552999996 3662082.4016999993, 653820.0124000004 3662171.2115, 653820.1595999999 3662183.236199999, 653792.5482000001 3662348.1658999994, 653791.6009999998 3662353.7851, 653781.5144999996 3662361.146299999, 653728.4446999999 3662507.657400001, 653671.5557000004 3662572.8285000008, 653653.1468000002 3662613.1909, 653636.9178999998 3662676.4640999995, 653603.4365999997 3662706.4235999994, 653511.6352000004 3662727.8676999994, 653355.4979999997 3662804.2095, 653285.5619999999 3662892.0398999993, 653236.5997000001 3662937.011600001, 653195.6449999996 3662956.6963, 653096.7598000001 3662945.0124999993, 653065.5815000003 3662990.2556999996, 653006.8463000003 3663174.7968000006, 652954.9117999999 3663247.657299999, 652939.0789999999 3663285.5176999997, 652889.5647 3663366.0539999995, 652832.6676000003 3663431.2218999993, 652722.1668999996 3663513.3430000003, 652663.2879999997 3663542.9092999995, 652560.2468999997 3663635.3223, 652556.0854000002 3663739.4067, 652545.1127000004 3663792.5967999995, 652536.2607000005 3664036.3290999997, 652548.2521000002 3664082.2467, 652543.9905000003 3664193.9526000004, 652506.5543 3664315.308, 652465.0436000004 3664535.677100001, 652435.7717000004 3664621.5955999997, 652429.5937000001 3664692.627800001, 652458.4603000004 3664797.227, 652462.6322999997 3664855.7327999994, 652449.3085000003 3664896.1689999998, 652371.9408 3664971.194, 652363.0608999999 3665052.335999999, 652349.7772000004 3665090.2368, 652289.9139 3665183.3023000006, 652286.8097000001 3665218.8330000006, 652309.0776000004 3665257.2727000006, 652316.1898999996 3665290.411699999, 652310.3291999996 3665341.1306999996, 652229.4002999999 3665482.1427999996, 652200.5158000002 3665542.6554000005, 652204.2995999996 3665626.5602, 652256.5055999998 3665701.0299999993, 652268.727 3665731.6975999996, 652279.6161000002 3665848.7266000006, 652334.3914000001 3665920.6933999993, 652363.8936999999 3665984.6586000007, 652364.9463 3666081.2236, 652350.9786999999 3666162.3012000006, 652345.7969000004 3666169.8362000007, 652342.1908999998 3666238.3652, 652368.5877999999 3666337.8538000006, 652373.2402999997 3666365.875, 652393.0130000003 3666401.7401, 652397.4551999997 3666442.4532999992, 652451.9153000005 3666534.7491999995, 652506.8893999998 3666594.0327000003, 652548.9304999998 3666668.3533999994, 652545.2105 3666744.4964000005, 652516.7748999996 3666777.0957999993, 652437.5252999999 3666808.8882, 652424.5932999998 3666823.9327000007, 652421.6599000003 3666849.2848000005, 652443.9687000001 3666885.204399999, 652446.0434999997 3666915.7216, 652424.8196 3666973.8168, 652378.5454000002 3667008.667199999, 652375.6517000003 3667031.476500001, 652390.4205 3667062.1988999993, 652399.8767999997 3667108.0699000005, 652386.8995000003 3667125.649700001, 652381.5015000002 3667145.8913000003, 652309.7216999996 3667187.9749, 652225.4801000003 3667214.6187999994, 652230.1721000001 3667240.0897000004, 652272.7203000002 3667281.3890000004, 652282.4349999996 3667309.489, 652274.1624999996 3667352.5402000006, 652209.5685 3667422.6702999994, 652195.2202000003 3667529.147399999, 652171.9693999998 3667554.1832999997, 652089.9856000002 3667598.6602999996, 652095.9171000002 3667707.9817999993, 652087.8702999996 3667735.7979000006, 652033.6393999998 3667793.387700001, 651944.1191999996 3667832.6468, 651900.4336000001 3667865.0034999996, 651892.4270000001 3667890.276799999, 651884.9901 3668042.592599999, 651863.6469999999 3668108.3100000005, 651857.8744999999 3668153.9438000005, 651847.3909 3668174.1139, 651841.4483000003 3668229.9042000007, 651825.8965999996 3668249.9956, 651823.0438000001 3668270.2695000004, 651783.9742 3668333.1681999993, 651746.5619999999 3668451.9976000004, 651735.0993999997 3668535.6435000002, 651732.8305000002 3668682.9526000004, 651757.2861000001 3668744.2947000004, 651758.4879000001 3668830.7029, 651747.8600000003 3668861.0227000006, 651705.2654999997 3668929.5897000004, 651698.1442999998 3668941.0524000004))","MULTILINESTRING((339186.51939999964 3692030.0365999993, 339208.5432000002 3692138.9244999997, 339222.45529999956 3692217.4595999997, 339221.1074000001 3692293.6894000005, 339122.4008999998 3692480.6699, 339120.0072999997 3692653.4520999994, 339127.2156999996 3692790.514799999, 339137.8457000004 3692820.8406000007, 339161.0719999997 3692843.3409, 339184.0393000003 3692850.613, 339328.92650000006 3692855.9738, 339437.9255999997 3692841.5744000003, 339565.12430000026 3692852.304300001, 339995.5987999998 3692926.8731999993, 340181.34779999964 3692946.8563, 340333.02660000045 3692898.769099999, 340516.9343999997 3692799.3763999995, 340675.81709999964 3692725.7764, 340743.6102 3692673.9214999992, 340791.0692999996 3692622.3863999993, 340971.65940000024 3692309.6402000003, 341063.05510000046 3692143.098099999, 341065.32579999976 3692125.2847000007, 341161.8411999997 3691961.1961000003, 341166.5724999998 3691938.2624999993, 341226.22059999965 3691853.499500001, 341271.4570000004 3691822.3234, 341324.67349999957 3691813.8729, 341365.5044 3691825.930299999, 341453.99430000037 3691961.7295999993, 341488.14740000013 3692034.8707999997, 341520.3189000003 3692143.5966, 341543.6531999996 3692173.7316999994, 341576.8766000001 3692185.9069, 341617.46300000045 3692182.7369, 341725.7745000003 3692122.6261, 341864.86670000013 3692082.3561000004, 341946.17069999967 3692083.6253999993, 342089.1878000004 3692132.2192, 342158.26999999955 3692164.1689, 342243.50129999965 3692254.2863, 342333.18200000003 3692303.700099999, 342438.03359999973 3692347.8028999995, 342510.0091000004 3692402.556399999, 342574.53139999975 3692467.613500001, 342580.0471000001 3692495.467, 342588.1738999998 3692690.9448000006, 342621.6994000003 3692723.4529999997, 342685.47250000015 3692740.2378000002, 342728.44120000023 3692726.8664999995, 342795.91449999996 3692654.682600001, 342838.8901000004 3692641.3191, 342957.82070000004 3692611.5292000007, 342987.7812999999 3692578.0354999993, 343059.5691999998 3692457.5209999997, 343089.47339999955 3692418.9486, 343102.09609999973 3692413.6865999997, 343296.6832999997 3692429.2607000005))", "MULTILINESTRING((559331.0131000001 3813860.4627, 559331.4161 3813794.4170999993, 559298.4918999998 3813778.9703, 559245.3547 3813748.1728000008, 559197.6183000002 3813661.5123999994, 559124.0384 3813648.358100001, 559068.4757000003 3813597.2158000004, 559030.4259000001 3813589.3669000007, 558928.7965000002 3813591.2729, 558903.5005000001 3813575.8905999996, 558835.3948999997 3813496.7325999998, 558799.9722999996 3813476.1929, 558777.0761000002 3813481.1271, 558766.8054 3813498.8421, 558766.5768999998 3813536.943600001, 558753.7071000002 3813564.8073999994, 558733.3782000002 3813564.6788999997, 558644.8065 3813510.8025, 558579.2580000004 3813431.655099999, 558533.7154999999 3813400.8948999997, 558495.8563000001 3813362.5612000003, 558488.5302999998 3813314.2469999995, 558415.3614999996 3813235.0604, 558407.9293 3813204.5402000006, 558446.3837000001 3813146.355900001, 558443.9223999996 3813133.6319999993, 558373.1017000005 3813084.9340000004, 558307.5000999998 3813013.4103999995, 558239.6546 3812896.1558, 558151.3596000001 3812796.5462999996, 558128.7478 3812755.7737000007, 558123.9253000002 3812715.0976, 558086.3920999998 3812620.8925, 558099.3722000001 3812575.255999999, 558092.1129999999 3812516.7699999996, 558044.3425000003 3812437.7378000002, 558001.4199999999 3812394.2884, 557938.1682000002 3812353.2631, 557877.3685999997 3812327.4902, 557776.1133000003 3812271.0003999993, 557639.1432999996 3812239.6774000004, 557616.3828999996 3812224.299799999, 557543.3361999998 3812124.7761000004, 557525.8378999997 3812076.4221, 557531.1094000004 3812045.966600001, 557572.1796000004 3811977.622300001, 557567.2599 3811952.1975, 557504.1567000002 3811888.3101000004, 557489.1427999996 3811850.114499999, 557484.6087999996 3811761.1875, 557466.9145999998 3811748.3773, 557408.5198999997 3811742.937999999, 557352.9484999999 3811691.7990000006, 557310.0377000002 3811648.353, 557320.6205000002 3811579.8422, 557308.2001 3811534.0409999993, 557242.5724 3811467.589400001, 557212.7966999998 3811350.5698000006, 557144.7094 3811271.4103999995, 557142.3609999996 3811240.9079, 557155.1978000002 3811218.135399999, 557173.0401999997 3811208.0725, 557183.4038000004 3811175.1271, 557158.1668999996 3811149.562999999, 557122.6317999996 3811144.265900001, 557051.7078999998 3811110.821799999, 556910.7591000004 3810901.6658999994, 556903.6953999996 3810812.7238999996, 556838.125 3810733.5748999994, 556783.0493000001 3810603.6942999996, 556773.6375000002 3810481.714400001, 556748.6297000004 3810418.0649999995, 556748.8773999996 3810377.4208000004, 556761.7267000005 3810354.6330999993, 556761.8661000002 3810331.7827000003, 556741.9450000003 3810265.621200001, 556666.5163000003 3810140.6888999995, 556659.4835999999 3810044.125499999, 556642.4090999998 3809929.7213000003, 556590.0961999996 3809764.2847000007, 556570.7155999998 3809611.7715000007, 556591.3989000004 3809550.9361000005, 556675.6505000005 3809480.3222000003, 556719.2180000003 3809417.1054, 556732.2015000004 3809371.460000001, 556732.4458999997 3809333.3588999994, 556743.4445000002 3809196.2523, 556744.9671 3808947.3457999993, 556700.1507000001 3808799.7415999994, 556592.2742999997 3808583.164000001, 556549.8262 3808463.5347000007, 556532.9627999999 3808313.5582, 556559.1097999997 3808191.8023000006, 556551.8705000002 3808130.789999999, 556570.2887000004 3808026.766899999, 556527.8684999999 3807902.044399999, 556508.2204999998 3807792.6966999993, 556488.1407000003 3807754.4799000006, 556455.3165999996 3807721.25, 556399.8722999999 3807652.323999999, 556385.1107999999 3807573.5014999993, 556347.6179999998 3807474.204, 556333.1660000002 3807347.1159000006, 556349.1168 3807230.3769000005, 556314.7911999999 3807029.4998000003, 556331.0615999997 3806861.9520999994, 556313.6694 3806798.3356999997, 556306.8322000001 3806671.3013000004, 556238.9963999996 3806551.498400001, 556219.4397 3806426.9232, 556191.8460999997 3806370.8674, 556172.0526999999 3806284.3784, 556159.4780000001 3806263.987299999, 556033.1732999999 3806151.4486999996, 555980.3388 3806067.2972999997))", "MULTILINESTRING((566020.3322999999 3629309.670600001, 566025.3285999997 3629322.4016999993, 566073.4024999999 3629355.7009999994, 566164.6897999998 3629381.6469, 566273.8324999996 3629394.9932000004, 566566.2339000003 3629345.9123, 566637.3425000003 3629346.3313999996, 566781.8757999996 3629387.815199999, 566842.8081 3629395.8022000007, 566903.8854999999 3629375.8376, 567039.0436000004 3629285.1843999997, 567166.8097999999 3629156.397, 567258.5908000004 3629098.512599999, 567304.7007999998 3629032.7501999997, 567312.7260999996 3628964.2235000003, 567260.4488000004 3628783.5720000006, 567255.7660999997 3628717.494000001, 567279.0290000001 3628649.0635, 567363.2279000003 3628586.0507999994, 567401.8603999997 3628494.8424999993, 567440.0954999998 3628472.198000001, 567496.2858999996 3628419.188100001, 567506.6881999997 3628378.6158000007, 567524.7017999999 3628340.6230999995, 567533.0650000004 3628213.6730000004, 567540.7330999998 3628206.0829000007, 567543.4740000004 3628173.0858999994, 567579.4946999997 3628094.5656000003, 567595.1216000002 3628028.6039000005, 567595.5492000002 3627954.9407, 567588.0466999998 3627934.564200001, 567588.4062999999 3627873.613, 567645.1627000002 3627729.166099999, 567655.5712000001 3627686.0440999996, 567704.4018999999 3627589.8069, 567714.7997000003 3627549.2421000004, 567755.7682999996 3627493.6018000003, 567821.9968999997 3627460.9727, 567883.2483000001 3627413.0698000006, 567901.1781000001 3627387.7675, 567906.4091999996 3627362.393100001, 567924.3216000004 3627339.6481, 567934.7204999998 3627299.076300001, 568003.6539000003 3627241.0566000007, 568046.9123 3627226.0764000006, 568046.9583999999 3627218.4492000006, 568080.1414000001 3627193.2446, 568164.0793000003 3627173.4223999996, 568215.0313999997 3627148.3183999993, 568235.4859999996 3627125.5766000003, 568403.7511999998 3627019.8921000008, 568414.0071 3627002.1728000008, 568567.0371000003 3626898.9284000006, 568671.6840000004 3626813.1853, 568725.0986000001 3626800.798800001, 568849.5700000003 3626799.0019000005, 568897.9899000004 3626771.333799999, 568964.3551000003 3626715.8378999997, 568969.5196000002 3626703.1686000004, 568982.2482000003 3626698.1722999997, 569081.9176000003 3626594.6086999997, 569094.8923000004 3626548.9634000007, 569156.2130000005 3626488.3707999997, 569510.0988999996 3626350.7566, 569791.9000000004 3626375.2795, 569814.8241999997 3626365.2486000005, 569850.5954999998 3626327.3629, 569881.8306 3626203.095899999, 569892.0784 3626187.9131000005, 569930.3335999995 3626162.7282, 570019.3420000002 3626142.9422999993, 570072.8332000002 3626117.8433999997, 570129.0027000001 3626069.9180999994, 570172.6377999997 3625991.445800001, 570185.7704999996 3625946.3573000003, 570204.0538999997 3625885.5478000008, 570196.9005000005 3625829.6061000004, 570212.3293000003 3625806.8696999997, 570212.6427999996 3625768.7785, 570264.8207 3625601.5638999995, 570298.3169999998 3625543.4196000006, 570515.9389000004 3625336.9367999993, 570559.3311999999 3625311.8795, 570638.2312000003 3625292.204500001, 570656.2457999997 3625264.4168999996, 570689.9515000004 3625180.8797999993, 570741.1332999999 3625135.5755000003, 570815.0369999995 3625105.7036000006, 570944.6174999997 3625101.6999999993, 570982.6305999998 3625112.1717000008, 571025.4101 3625160.7931999993, 571121.4693 3625217.454, 571255.8870999999 3625241.434699999, 571388.3075000001 3625201.876700001, 571545.7823999999 3625203.1817000005, 571614.5133999996 3625185.968800001, 571657.8905999996 3625160.9159999993, 571719.3658999996 3625100.4729999993, 571737.4265000001 3625065.0600000005, 571745.4687000001 3625014.3194999993, 571737.8502000002 3625014.257099999, 571700.4018999999 3624935.2123000007, 571629.7898000004 3624873.6593999993, 571601.9486999996 3624860.7310000006, 571599.6217 3624835.3038, 571577.3110999996 3624769.081599999, 571587.8279999997 3624418.6446, 571582.1695999997 3624182.3713000007, 571603.1593000004 3624101.258300001, 571646.7127999999 3624055.9034, 571672.6644000001 3623990.0593, 571697.5352999996 3623839.6097, 571702.8706999999 3623809.1602999996, 571782.7731999997 3623667.5714, 571765.6612999998 3623586.1536, 571766.0051999995 3623545.5128000006, 571809.4879999999 3623507.7635999992, 571890.6640999997 3623521.1230999995, 571918.7483000001 3623503.5807000007, 571952.5870000003 3623404.800899999, 571955.5103000002 3623356.558599999, 571920.6788999997 3623267.3697999995, 571903.0878999997 3623244.3596, 571900.9271 3623198.615599999, 571954.3956000004 3623183.8146, 572015.7735000001 3623133.5130000003, 572077.3920999998 3623052.7402, 572103.3918000003 3622979.292199999, 572103.7862 3622931.0242, 572122.3820000002 3622832.1268000007, 572107.4622999998 3622793.8881, 572049.5168000003 3622734.9968, 572050.0464000003 3622671.4968, 572198.7066000002 3622507.6018000003, 572260.3488999996 3622424.287799999, 572260.4786 3622409.0483999997, 572286.0181 3622391.4811000004, 572324.4790000003 3622348.612400001, 572401.8037 3622212.0798000004, 572474.3117000004 3622042.489499999, 572548.5162000004 3621977.0516999997, 572592.2566 3621908.8269999996, 572633.0646000002 3621888.837099999, 572759.9907 3621897.504899999, 572775.5866999999 3621854.4333999995, 572760.6985999998 3621811.1458, 572670.5866999999 3621650.3813000005, 572668.3728999998 3621609.7217999995, 572697.8660000004 3621419.4486, 572758.9790000003 3621402.1724999994, 572845.2747999998 3621410.4992999993, 572888.8081999999 3621367.6699, 572965.2766000004 3621335.2675, 573001.1770000001 3621294.9323999994, 573029.7366000004 3621218.955600001, 573068.1179 3621183.7092000004, 573088.4957999997 3621176.2611999996, 573091.2128999997 3621155.963199999, 573122.1290999996 3621102.8718999997, 573140.0082999999 3621090.3205999993, 573150.4156999998 3621059.9240000006, 573140.7006000001 3621006.503900001, 573169.0624000002 3620955.9364, 573174.3848000001 3620925.4876000006, 573207.7822000002 3620880.0571, 573281.6753000002 3620852.7083, 573335.0335999997 3620850.6041, 573403.7856999999 3620828.2958000004, 573478.0928999996 3620750.1677, 573574.9411000004 3620710.315300001, 573714.7712000003 3620696.2300000004, 573760.6153999995 3620681.374399999, 573793.5891000004 3620686.7191000003, 573849.875 3620636.383199999, 573860.2346000001 3620613.5997, 573901.2269000001 3620570.7556999996, 573925.1569999997 3620438.8706, 573938.0093999999 3620421.1908, 573986.5179000003 3620391.1083000004, 574133.8997 3620384.7052999996, 574187.3558 3620369.8936, 574279.4033000004 3620296.9740999993, 574310.5499 3620215.9572, 574311.3217000002 3620121.971000001, 574319.0071 3620114.4231000002, 574321.8285999997 3620078.8784999996, 574450.9254000001 3619823.3905999996, 574474.2874999996 3619762.6117000002, 574482.4108999996 3619701.7039, 574477.8823999995 3619635.6308999993, 574450.7328000003 3619538.892999999, 574435.5696999999 3619528.602, 574428.2759999996 3619490.4464, 574426.2966999998 3619421.8354, 574439.2211999996 3619394.0088, 574467.3409000002 3619371.3812000006, 574530.9560000002 3619359.1973, 574579.3764000004 3619339.2796, 574612.7163000004 3619298.9087000005, 574625.6730000004 3619268.5327000003, 574643.5763999997 3619253.4416000005, 574656.5905999998 3619215.4385, 574616.5162000004 3619146.519099999, 574617.0747999996 3619077.956599999, 574643.3129000003 3618976.556399999, 574658.6990999999 3618958.8965000007, 574750.1465999996 3618957.1152999997, 574788.6124999998 3618914.2557999995, 574801.6151999999 3618876.2455, 574847.5014000004 3618856.3172999993, 574883.0813999996 3618854.057499999, 574993.3272000002 3618730.4975000005, 575009.3716000002 3618631.556500001, 575057.9369999999 3618593.8665999994, 575058.4535999997 3618532.901799999, 574995.4123999998 3618476.4978, 574985.4304999998 3618453.562000001, 574995.7632999998 3618433.3147, 575029.0564000001 3618400.5723, 575029.2352999998 3618377.713199999, 575011.7121000001 3618347.0929000005, 575012.1904999996 3618288.6702999994, 575020.0246000001 3618263.333799999, 575050.8519000001 3618220.4027999993, 575061.2807999998 3618187.4658000004, 575099.8406999996 3618131.902899999, 575102.6139000002 3618103.9857, 575110.2698999997 3618098.9659, 575110.4807000002 3618073.5571, 575095.4689999996 3618045.4834000003, 575095.8262999998 3618002.3149999995, 575131.6075999998 3617974.669399999, 575164.9987000003 3617929.2229999993, 575233.7882000003 3617904.3773, 575267.0393000003 3617876.7129999995, 575269.7427000003 3617856.4229000006, 575254.7504000003 3617825.8138999995, 575252.5458000004 3617785.1538999993, 575267.9732999997 3617762.4177, 575268.1458999999 3617742.101, 575298.7516999999 3617727.1072000004, 575301.4298 3617709.3445999995, 575324.3476 3617701.912900001, 575357.7275 3617659.0095000006, 575365.8705000002 3617595.5747999996, 575404.3192999996 3617552.710000001, 575462.9312000005 3617530.316299999, 575475.7133999998 3617520.2654999997, 575445.9401000002 3617433.6531000007, 575446.2734000003 3617393.0270000007, 575469.4932000004 3617350.0320999995, 575457.1789999995 3617301.6678, 575439.5465000002 3617283.7364000008, 575391.2679000003 3617285.8758000005, 575376.1593000004 3617270.5209999997, 575376.4477000004 3617234.9574999996, 575394.5608999999 3617194.4736, 575473.9607999995 3617113.8411, 575494.5542000001 3617080.9964000005, 575494.8299000002 3617047.9680000003, 575462.2741 3616991.8225, 575457.5779999997 3616943.5160000008, 575498.7208000002 3616882.874399999, 575547.1743999999 3616860.4188, 575674.3649000004 3616836.064099999, 575717.9245999996 3616790.696799999, 575715.7408999996 3616747.4944, 575701.0180000002 3616683.8784999996, 575614.0193999996 3616452.010399999, 575563.7637999998 3616385.5600000005, 575475.2653000001 3616336.573000001, 575465.2560999999 3616318.7068000007, 575468.1595000001 3616272.9932000004, 575542.3442000002 3616210.1116000004, 575565.8365000002 3616134.1032999996, 575587.0747999996 3616019.969900001, 575595.6244999999 3615908.2751, 575603.2823999999 3615903.2631, 575603.4106999999 3615888.0237000007, 575613.6898999996 3615872.8542, 575619.2723000003 3615811.9428000003, 575627.0199999996 3615796.7687999997, 575646.0684000002 3615641.9681, 575661.5834999997 3615609.0703999996, 575667.1664000005 3615548.1591, 575682.7659 3615502.5569, 575693.4693999998 3615436.606899999, 575729.4285000004 3615388.6466000006, 575783.0428999998 3615356.0613, 575806.1723999996 3615323.2292, 575804.0722000003 3615269.8648000006, 575773.6316999998 3615264.5330999997, 575745.9797 3615228.7496000007, 575741.2832000004 3615182.992900001, 575766.8930000002 3615157.785, 575787.5428999998 3615117.3212, 575767.9735000003 3615025.7229999993, 575752.125 3614789.355900001, 575765.1229999997 3614753.903999999, 575806.1864 3614703.4404000007, 575903.4851000002 3614607.7070000004, 575959.6298000002 3614575.1417999994, 576028.3611000003 3614557.928099999, 576074.9417000003 3614454.1592999995, 576098.1518999999 3614411.1732, 576138.9212999996 3614396.266899999, 576215.9733999996 3614292.7613999993, 576242.1041000001 3614204.069700001, 576290.9424 3614133.334899999, 576336.8674999997 3614108.3136, 576407.9016000004 3614119.043400001, 576436.2027000003 3614076.1043999996, 576434.8191 3613933.853599999, 576447.6912000002 3613913.6272, 576502.4455000004 3613741.3564999998, 576548.8925000001 3613652.8290999997, 576710.0093 3613519.523, 576799.3097999999 3613471.9849999994, 576895.9066000003 3613462.634299999, 576918.8881000001 3613447.564200001, 576924.1991999997 3613419.6819, 576936.9819 3613409.6253999993, 576944.7922999999 3613386.8253000006, 576980.5629000003 3613361.721000001, 577033.8082999997 3613372.3102, 577066.8969999999 3613364.9608999994, 577118.068 3613319.658399999, 577204.6316 3613294.9630999994, 577306.3531 3613280.5637999997, 577364.9237000002 3613263.2728000004, 577405.9369000001 3613217.8706, 577541.0719999997 3613155.4847, 577576.6678999998 3613150.6917000003, 577734.7093000002 3613083.401799999, 577841.5505999997 3613063.9553999994, 577900.2427000003 3613031.4208000004, 577984.2662000004 3613006.7123000007, 578068.6211999999 3612941.3564, 578160.4595999997 3612893.8355, 578227.2006999999 3612808.0320999995, 578345.0031000003 3612692.1500000004, 578378.3687000005 3612649.2413999997, 578383.6182000004 3612628.9573999997, 578411.8870999999 3612588.5513000004, 578430.2082000002 3612522.663899999, 578445.6783999996 3612494.8476, 578478.8712999998 3612474.7984999996, 578545.0321000004 3612460.0944, 578573.2419999996 3612427.3011000007, 578596.7681999998 3612346.2147000004, 578624.9786 3612313.421599999, 578650.8636999996 3612255.2071, 578714.8148999996 3612199.858100001, 578725.2227999996 3612169.467, 578750.8892999999 3612136.654100001, 578791.6597999996 3612121.7435, 578883.0091000004 3612132.6514, 578936.5522999996 3612110.229800001, 579071.1847999999 3612108.7994, 579114.5691999998 3612083.7480999995, 579269.6656999998 3612064.6926000006, 579302.9627999999 3612031.9492000006, 579380.7189999996 3612008.9540999997, 579479.0724 3612011.2682000007, 579431.5049 3611953.7707, 579365.0266000004 3611899.397, 579330.0033 3611792.3099000007, 579270.1544000003 3611667.685900001, 579282.8570999997 3611578.6805000007, 579371.6498999996 3611531.9146999996, 579446.4910000004 3611486.0066, 579488.0356000001 3611456.8477, 579536.3735999996 3611447.0855, 579681.2051999997 3611440.659499999, 579736.7472000001 3611481.762, 579790.0739000002 3611484.7239999995, 579859.5214 3611378.619999999, 579867.7878999999 3611299.9344999995, 579891.1172000002 3611244.245100001, 579893.9206999997 3611211.2664, 579940.0883 3611155.7380999997, 579960.8119000001 3611107.6555000003, 579994.0267000003 3611085.0615, 580091.6589000002 3610948.704500001, 580173.0869000005 3610931.583799999, 580231.9787999997 3610873.6536, 580313.6061000004 3610831.139799999, 580364.9358999999 3610768.0495999996, 580413.926 3610679.545, 580498.1091 3610634.5108000003, 580577.3565999996 3610574.1970000006, 580600.8227000004 3610500.7273999993, 580603.9494000003 3610429.6358000003, 580703.1564999996 3610412.6630000006, 580723.7225000001 3610382.3636000007, 580721.4571000002 3610349.3071999997, 580708.8866999997 3610331.4224999994, 580704.0882000001 3610298.3603000008, 580745.0975000001 3610252.978700001, 580811.2435999997 3610240.8242000006, 580829.1540000001 3610225.7216999996, 580834.3762999997 3610207.9957999997, 580804.2150999997 3610169.642999999, 580796.9349999996 3610126.4053000007, 580809.8762999997 3610098.5571999997, 580845.8021 3610053.1421000008, 580871.4128999999 3610027.9394000005, 580957.9839000003 3610003.2536999993, 580991.1796000004 3609980.6701999996, 581096.3589000003 3609854.5096000005, 581147.3344999999 3609834.6138000004, 581195.5932 3609835.0067, 581231.3770000003 3609807.3598999996, 581234.2888000002 3609761.6624999996, 581224.3591999998 3609733.6433000006, 581222.2067999998 3609685.3620999996, 581240.1187000005 3609670.2676, 581240.8969 3609576.2891000006, 581281.8575999998 3609535.9942000005, 581381.4003999997 3609478.365, 581422.0635000002 3609476.161800001, 581464.9692000002 3609509.535599999, 581535.9382999996 3609527.8987000007, 581571.6201999998 3609512.950099999, 581638.5086000003 3609409.3573000003, 581687.1355999997 3609366.5768, 581768.5899999999 3609344.3839, 581852.8531 3609291.726399999, 581898.5959000001 3609289.5742000006, 581928.9227 3609307.6063, 581964.4599000001 3609310.4334999993, 582005.3745999997 3609277.7465000004, 582031.3454999998 3609209.363500001, 582044.3499999996 3609171.3695, 582090.4069999997 3609131.112400001, 582139.1589000002 3609070.5374, 582169.7163000004 3609060.6262999997, 582203.2862999998 3608994.8709999993, 582336.0865000002 3608907.0517999995, 582384.6792000001 3608866.8094999995, 582415.2648 3608854.356899999, 582443.4787999997 3608821.5742000006, 582477.2553000003 3608730.3960999995, 582496.4631000003 3608555.290100001, 582509.3502000002 3608532.5361, 582542.5965 3608504.858100001, 582624.0598999998 3608482.6719000004, 582670.0171999997 3608455.107000001, 582877.5636999998 3608235.8136, 582964.3505999995 3608183.1787, 582972.2654999997 3608147.6860000007, 582990.1913999999 3608130.052100001, 583048.7319 3608115.2841, 583092.1672 3608085.1722999997, 583107.6383999996 3608057.348099999, 583107.9346000003 3608021.7994, 583080.3931 3607973.3061999995, 583078.3335999995 3607914.862400001, 583098.8844999997 3607887.0878, 583172.892 3607844.511, 583180.7018999998 3607821.7228999995, 583208.915 3607788.934699999, 583285.3300999999 3607761.6118, 583326.2577999998 3607726.387599999, 583397.6127000004 3607699.0308, 583441.0597000001 3607666.3706, 583495.1552999998 3607575.365700001, 583536.2335000001 3607522.3532, 583562.1365999999 3607461.601, 583659.4091999996 3607368.4234999996, 583718.5820000004 3607277.4549000002, 583747.0203999998 3607216.7316999994, 583788.9357000003 3607062.1218999997, 583799.1748000002 3607052.045, 583817.4480999997 3606991.2293999996, 583928.2884999998 3606796.5481000002, 583946.6759000001 3606723.0430999994, 583975.1902999999 3606652.1436))"],
                "P": [36,0,0,0],
                "I": [8,0,24,0],
                "E": [0,0,0,6],
                "Unknown": [1,1,0,0],
                "ALI": [0,0,0,0],
                "Class_Wt": ["P","U","I","E"],
              
            }
        )

        df2["geometry"] = gpd.GeoSeries.from_wkt(df2["geometry"])

        gdf=gpd.GeoDataFrame(df2,geometry="geometry")


        
        x2=flow_classification.flow_classification(GDB_Path= r"tests/ADEQ_FlowRegimes_Test\Flow_Regimes.gdb", Obs_Layer='FlowRegime_Observations', SHP_Layer='WBID_FlwRgme_Designations', Unique_ID_Shp='WBID', Geometry_Column='geometry', Unique_ID_Obs='WBID', Flow_Regime_Column='Flow_Regime', Priority_Column='Priority')
        for i in range(len(x2)):
            for j in range(len(x2['WBID'])):
                self.assertEqual( x2.iloc[i][j], gdf.iloc[i][j])

    def test_flowclass2(self):

        df2 = pd.DataFrame(
                {
            "index": [0,1,2,3],
            "WBID": ["AZ15040004-036B", "AZ15070103-090", "AZ15020005-018", "AZ15050203-006"],
            "geometry": ["MULTILINESTRING((655758.2795000002 3660253.021400001, 655749.0778000001 3660300.8320000004, 655710.8260000004 3660310.4054000005, 655667.8926999997 3660294.5067, 655629.2379000001 3660329.4573, 655607.4277999997 3660425.6603999995, 655586.2912999997 3660478.679199999, 655532.0976 3660533.7314, 655485.2806000002 3660604.1324000005, 655361.2921000002 3660736.8527000006, 655299.5915999999 3660784.1787, 655207.4490999999 3660828.4793, 655122.6560000004 3660890.6866999995, 655052.9508999996 3660963.2707, 655000.5913000004 3661064.0636, 654989.3279999997 3661135.036699999, 654971.1187000005 3661162.6827000007, 654857.5689000003 3661277.7990000006, 654791.0310000004 3661309.7831999995, 654645.3112000003 3661533.6229999997, 654580.4050000003 3661624.0754000004, 654503.6217999998 3661660.994000001, 654413.6699000001 3661728.197899999, 654262.7995999996 3661791.9214999992, 654170.5119000003 3661846.373299999, 654089.0350000001 3661857.8232000005, 654055.8291999996 3661870.0108000003, 654022.3438999997 3661899.976399999, 653978.0366000002 3661972.9667000007, 653939.4342999998 3662005.3882, 653891.057 3662012.2656999994, 653855.0736999996 3662039.6491, 653826.4552999996 3662082.4016999993, 653820.0124000004 3662171.2115, 653820.1595999999 3662183.236199999, 653792.5482000001 3662348.1658999994, 653791.6009999998 3662353.7851, 653781.5144999996 3662361.146299999, 653728.4446999999 3662507.657400001, 653671.5557000004 3662572.8285000008, 653653.1468000002 3662613.1909, 653636.9178999998 3662676.4640999995, 653603.4365999997 3662706.4235999994, 653511.6352000004 3662727.8676999994, 653355.4979999997 3662804.2095, 653285.5619999999 3662892.0398999993, 653236.5997000001 3662937.011600001, 653195.6449999996 3662956.6963, 653096.7598000001 3662945.0124999993, 653065.5815000003 3662990.2556999996, 653006.8463000003 3663174.7968000006, 652954.9117999999 3663247.657299999, 652939.0789999999 3663285.5176999997, 652889.5647 3663366.0539999995, 652832.6676000003 3663431.2218999993, 652722.1668999996 3663513.3430000003, 652663.2879999997 3663542.9092999995, 652560.2468999997 3663635.3223, 652556.0854000002 3663739.4067, 652545.1127000004 3663792.5967999995, 652536.2607000005 3664036.3290999997, 652548.2521000002 3664082.2467, 652543.9905000003 3664193.9526000004, 652506.5543 3664315.308, 652465.0436000004 3664535.677100001, 652435.7717000004 3664621.5955999997, 652429.5937000001 3664692.627800001, 652458.4603000004 3664797.227, 652462.6322999997 3664855.7327999994, 652449.3085000003 3664896.1689999998, 652371.9408 3664971.194, 652363.0608999999 3665052.335999999, 652349.7772000004 3665090.2368, 652289.9139 3665183.3023000006, 652286.8097000001 3665218.8330000006, 652309.0776000004 3665257.2727000006, 652316.1898999996 3665290.411699999, 652310.3291999996 3665341.1306999996, 652229.4002999999 3665482.1427999996, 652200.5158000002 3665542.6554000005, 652204.2995999996 3665626.5602, 652256.5055999998 3665701.0299999993, 652268.727 3665731.6975999996, 652279.6161000002 3665848.7266000006, 652334.3914000001 3665920.6933999993, 652363.8936999999 3665984.6586000007, 652364.9463 3666081.2236, 652350.9786999999 3666162.3012000006, 652345.7969000004 3666169.8362000007, 652342.1908999998 3666238.3652, 652368.5877999999 3666337.8538000006, 652373.2402999997 3666365.875, 652393.0130000003 3666401.7401, 652397.4551999997 3666442.4532999992, 652451.9153000005 3666534.7491999995, 652506.8893999998 3666594.0327000003, 652548.9304999998 3666668.3533999994, 652545.2105 3666744.4964000005, 652516.7748999996 3666777.0957999993, 652437.5252999999 3666808.8882, 652424.5932999998 3666823.9327000007, 652421.6599000003 3666849.2848000005, 652443.9687000001 3666885.204399999, 652446.0434999997 3666915.7216, 652424.8196 3666973.8168, 652378.5454000002 3667008.667199999, 652375.6517000003 3667031.476500001, 652390.4205 3667062.1988999993, 652399.8767999997 3667108.0699000005, 652386.8995000003 3667125.649700001, 652381.5015000002 3667145.8913000003, 652309.7216999996 3667187.9749, 652225.4801000003 3667214.6187999994, 652230.1721000001 3667240.0897000004, 652272.7203000002 3667281.3890000004, 652282.4349999996 3667309.489, 652274.1624999996 3667352.5402000006, 652209.5685 3667422.6702999994, 652195.2202000003 3667529.147399999, 652171.9693999998 3667554.1832999997, 652089.9856000002 3667598.6602999996, 652095.9171000002 3667707.9817999993, 652087.8702999996 3667735.7979000006, 652033.6393999998 3667793.387700001, 651944.1191999996 3667832.6468, 651900.4336000001 3667865.0034999996, 651892.4270000001 3667890.276799999, 651884.9901 3668042.592599999, 651863.6469999999 3668108.3100000005, 651857.8744999999 3668153.9438000005, 651847.3909 3668174.1139, 651841.4483000003 3668229.9042000007, 651825.8965999996 3668249.9956, 651823.0438000001 3668270.2695000004, 651783.9742 3668333.1681999993, 651746.5619999999 3668451.9976000004, 651735.0993999997 3668535.6435000002, 651732.8305000002 3668682.9526000004, 651757.2861000001 3668744.2947000004, 651758.4879000001 3668830.7029, 651747.8600000003 3668861.0227000006, 651705.2654999997 3668929.5897000004, 651698.1442999998 3668941.0524000004))","MULTILINESTRING((339186.51939999964 3692030.0365999993, 339208.5432000002 3692138.9244999997, 339222.45529999956 3692217.4595999997, 339221.1074000001 3692293.6894000005, 339122.4008999998 3692480.6699, 339120.0072999997 3692653.4520999994, 339127.2156999996 3692790.514799999, 339137.8457000004 3692820.8406000007, 339161.0719999997 3692843.3409, 339184.0393000003 3692850.613, 339328.92650000006 3692855.9738, 339437.9255999997 3692841.5744000003, 339565.12430000026 3692852.304300001, 339995.5987999998 3692926.8731999993, 340181.34779999964 3692946.8563, 340333.02660000045 3692898.769099999, 340516.9343999997 3692799.3763999995, 340675.81709999964 3692725.7764, 340743.6102 3692673.9214999992, 340791.0692999996 3692622.3863999993, 340971.65940000024 3692309.6402000003, 341063.05510000046 3692143.098099999, 341065.32579999976 3692125.2847000007, 341161.8411999997 3691961.1961000003, 341166.5724999998 3691938.2624999993, 341226.22059999965 3691853.499500001, 341271.4570000004 3691822.3234, 341324.67349999957 3691813.8729, 341365.5044 3691825.930299999, 341453.99430000037 3691961.7295999993, 341488.14740000013 3692034.8707999997, 341520.3189000003 3692143.5966, 341543.6531999996 3692173.7316999994, 341576.8766000001 3692185.9069, 341617.46300000045 3692182.7369, 341725.7745000003 3692122.6261, 341864.86670000013 3692082.3561000004, 341946.17069999967 3692083.6253999993, 342089.1878000004 3692132.2192, 342158.26999999955 3692164.1689, 342243.50129999965 3692254.2863, 342333.18200000003 3692303.700099999, 342438.03359999973 3692347.8028999995, 342510.0091000004 3692402.556399999, 342574.53139999975 3692467.613500001, 342580.0471000001 3692495.467, 342588.1738999998 3692690.9448000006, 342621.6994000003 3692723.4529999997, 342685.47250000015 3692740.2378000002, 342728.44120000023 3692726.8664999995, 342795.91449999996 3692654.682600001, 342838.8901000004 3692641.3191, 342957.82070000004 3692611.5292000007, 342987.7812999999 3692578.0354999993, 343059.5691999998 3692457.5209999997, 343089.47339999955 3692418.9486, 343102.09609999973 3692413.6865999997, 343296.6832999997 3692429.2607000005))", "MULTILINESTRING((559331.0131000001 3813860.4627, 559331.4161 3813794.4170999993, 559298.4918999998 3813778.9703, 559245.3547 3813748.1728000008, 559197.6183000002 3813661.5123999994, 559124.0384 3813648.358100001, 559068.4757000003 3813597.2158000004, 559030.4259000001 3813589.3669000007, 558928.7965000002 3813591.2729, 558903.5005000001 3813575.8905999996, 558835.3948999997 3813496.7325999998, 558799.9722999996 3813476.1929, 558777.0761000002 3813481.1271, 558766.8054 3813498.8421, 558766.5768999998 3813536.943600001, 558753.7071000002 3813564.8073999994, 558733.3782000002 3813564.6788999997, 558644.8065 3813510.8025, 558579.2580000004 3813431.655099999, 558533.7154999999 3813400.8948999997, 558495.8563000001 3813362.5612000003, 558488.5302999998 3813314.2469999995, 558415.3614999996 3813235.0604, 558407.9293 3813204.5402000006, 558446.3837000001 3813146.355900001, 558443.9223999996 3813133.6319999993, 558373.1017000005 3813084.9340000004, 558307.5000999998 3813013.4103999995, 558239.6546 3812896.1558, 558151.3596000001 3812796.5462999996, 558128.7478 3812755.7737000007, 558123.9253000002 3812715.0976, 558086.3920999998 3812620.8925, 558099.3722000001 3812575.255999999, 558092.1129999999 3812516.7699999996, 558044.3425000003 3812437.7378000002, 558001.4199999999 3812394.2884, 557938.1682000002 3812353.2631, 557877.3685999997 3812327.4902, 557776.1133000003 3812271.0003999993, 557639.1432999996 3812239.6774000004, 557616.3828999996 3812224.299799999, 557543.3361999998 3812124.7761000004, 557525.8378999997 3812076.4221, 557531.1094000004 3812045.966600001, 557572.1796000004 3811977.622300001, 557567.2599 3811952.1975, 557504.1567000002 3811888.3101000004, 557489.1427999996 3811850.114499999, 557484.6087999996 3811761.1875, 557466.9145999998 3811748.3773, 557408.5198999997 3811742.937999999, 557352.9484999999 3811691.7990000006, 557310.0377000002 3811648.353, 557320.6205000002 3811579.8422, 557308.2001 3811534.0409999993, 557242.5724 3811467.589400001, 557212.7966999998 3811350.5698000006, 557144.7094 3811271.4103999995, 557142.3609999996 3811240.9079, 557155.1978000002 3811218.135399999, 557173.0401999997 3811208.0725, 557183.4038000004 3811175.1271, 557158.1668999996 3811149.562999999, 557122.6317999996 3811144.265900001, 557051.7078999998 3811110.821799999, 556910.7591000004 3810901.6658999994, 556903.6953999996 3810812.7238999996, 556838.125 3810733.5748999994, 556783.0493000001 3810603.6942999996, 556773.6375000002 3810481.714400001, 556748.6297000004 3810418.0649999995, 556748.8773999996 3810377.4208000004, 556761.7267000005 3810354.6330999993, 556761.8661000002 3810331.7827000003, 556741.9450000003 3810265.621200001, 556666.5163000003 3810140.6888999995, 556659.4835999999 3810044.125499999, 556642.4090999998 3809929.7213000003, 556590.0961999996 3809764.2847000007, 556570.7155999998 3809611.7715000007, 556591.3989000004 3809550.9361000005, 556675.6505000005 3809480.3222000003, 556719.2180000003 3809417.1054, 556732.2015000004 3809371.460000001, 556732.4458999997 3809333.3588999994, 556743.4445000002 3809196.2523, 556744.9671 3808947.3457999993, 556700.1507000001 3808799.7415999994, 556592.2742999997 3808583.164000001, 556549.8262 3808463.5347000007, 556532.9627999999 3808313.5582, 556559.1097999997 3808191.8023000006, 556551.8705000002 3808130.789999999, 556570.2887000004 3808026.766899999, 556527.8684999999 3807902.044399999, 556508.2204999998 3807792.6966999993, 556488.1407000003 3807754.4799000006, 556455.3165999996 3807721.25, 556399.8722999999 3807652.323999999, 556385.1107999999 3807573.5014999993, 556347.6179999998 3807474.204, 556333.1660000002 3807347.1159000006, 556349.1168 3807230.3769000005, 556314.7911999999 3807029.4998000003, 556331.0615999997 3806861.9520999994, 556313.6694 3806798.3356999997, 556306.8322000001 3806671.3013000004, 556238.9963999996 3806551.498400001, 556219.4397 3806426.9232, 556191.8460999997 3806370.8674, 556172.0526999999 3806284.3784, 556159.4780000001 3806263.987299999, 556033.1732999999 3806151.4486999996, 555980.3388 3806067.2972999997))", "MULTILINESTRING((566020.3322999999 3629309.670600001, 566025.3285999997 3629322.4016999993, 566073.4024999999 3629355.7009999994, 566164.6897999998 3629381.6469, 566273.8324999996 3629394.9932000004, 566566.2339000003 3629345.9123, 566637.3425000003 3629346.3313999996, 566781.8757999996 3629387.815199999, 566842.8081 3629395.8022000007, 566903.8854999999 3629375.8376, 567039.0436000004 3629285.1843999997, 567166.8097999999 3629156.397, 567258.5908000004 3629098.512599999, 567304.7007999998 3629032.7501999997, 567312.7260999996 3628964.2235000003, 567260.4488000004 3628783.5720000006, 567255.7660999997 3628717.494000001, 567279.0290000001 3628649.0635, 567363.2279000003 3628586.0507999994, 567401.8603999997 3628494.8424999993, 567440.0954999998 3628472.198000001, 567496.2858999996 3628419.188100001, 567506.6881999997 3628378.6158000007, 567524.7017999999 3628340.6230999995, 567533.0650000004 3628213.6730000004, 567540.7330999998 3628206.0829000007, 567543.4740000004 3628173.0858999994, 567579.4946999997 3628094.5656000003, 567595.1216000002 3628028.6039000005, 567595.5492000002 3627954.9407, 567588.0466999998 3627934.564200001, 567588.4062999999 3627873.613, 567645.1627000002 3627729.166099999, 567655.5712000001 3627686.0440999996, 567704.4018999999 3627589.8069, 567714.7997000003 3627549.2421000004, 567755.7682999996 3627493.6018000003, 567821.9968999997 3627460.9727, 567883.2483000001 3627413.0698000006, 567901.1781000001 3627387.7675, 567906.4091999996 3627362.393100001, 567924.3216000004 3627339.6481, 567934.7204999998 3627299.076300001, 568003.6539000003 3627241.0566000007, 568046.9123 3627226.0764000006, 568046.9583999999 3627218.4492000006, 568080.1414000001 3627193.2446, 568164.0793000003 3627173.4223999996, 568215.0313999997 3627148.3183999993, 568235.4859999996 3627125.5766000003, 568403.7511999998 3627019.8921000008, 568414.0071 3627002.1728000008, 568567.0371000003 3626898.9284000006, 568671.6840000004 3626813.1853, 568725.0986000001 3626800.798800001, 568849.5700000003 3626799.0019000005, 568897.9899000004 3626771.333799999, 568964.3551000003 3626715.8378999997, 568969.5196000002 3626703.1686000004, 568982.2482000003 3626698.1722999997, 569081.9176000003 3626594.6086999997, 569094.8923000004 3626548.9634000007, 569156.2130000005 3626488.3707999997, 569510.0988999996 3626350.7566, 569791.9000000004 3626375.2795, 569814.8241999997 3626365.2486000005, 569850.5954999998 3626327.3629, 569881.8306 3626203.095899999, 569892.0784 3626187.9131000005, 569930.3335999995 3626162.7282, 570019.3420000002 3626142.9422999993, 570072.8332000002 3626117.8433999997, 570129.0027000001 3626069.9180999994, 570172.6377999997 3625991.445800001, 570185.7704999996 3625946.3573000003, 570204.0538999997 3625885.5478000008, 570196.9005000005 3625829.6061000004, 570212.3293000003 3625806.8696999997, 570212.6427999996 3625768.7785, 570264.8207 3625601.5638999995, 570298.3169999998 3625543.4196000006, 570515.9389000004 3625336.9367999993, 570559.3311999999 3625311.8795, 570638.2312000003 3625292.204500001, 570656.2457999997 3625264.4168999996, 570689.9515000004 3625180.8797999993, 570741.1332999999 3625135.5755000003, 570815.0369999995 3625105.7036000006, 570944.6174999997 3625101.6999999993, 570982.6305999998 3625112.1717000008, 571025.4101 3625160.7931999993, 571121.4693 3625217.454, 571255.8870999999 3625241.434699999, 571388.3075000001 3625201.876700001, 571545.7823999999 3625203.1817000005, 571614.5133999996 3625185.968800001, 571657.8905999996 3625160.9159999993, 571719.3658999996 3625100.4729999993, 571737.4265000001 3625065.0600000005, 571745.4687000001 3625014.3194999993, 571737.8502000002 3625014.257099999, 571700.4018999999 3624935.2123000007, 571629.7898000004 3624873.6593999993, 571601.9486999996 3624860.7310000006, 571599.6217 3624835.3038, 571577.3110999996 3624769.081599999, 571587.8279999997 3624418.6446, 571582.1695999997 3624182.3713000007, 571603.1593000004 3624101.258300001, 571646.7127999999 3624055.9034, 571672.6644000001 3623990.0593, 571697.5352999996 3623839.6097, 571702.8706999999 3623809.1602999996, 571782.7731999997 3623667.5714, 571765.6612999998 3623586.1536, 571766.0051999995 3623545.5128000006, 571809.4879999999 3623507.7635999992, 571890.6640999997 3623521.1230999995, 571918.7483000001 3623503.5807000007, 571952.5870000003 3623404.800899999, 571955.5103000002 3623356.558599999, 571920.6788999997 3623267.3697999995, 571903.0878999997 3623244.3596, 571900.9271 3623198.615599999, 571954.3956000004 3623183.8146, 572015.7735000001 3623133.5130000003, 572077.3920999998 3623052.7402, 572103.3918000003 3622979.292199999, 572103.7862 3622931.0242, 572122.3820000002 3622832.1268000007, 572107.4622999998 3622793.8881, 572049.5168000003 3622734.9968, 572050.0464000003 3622671.4968, 572198.7066000002 3622507.6018000003, 572260.3488999996 3622424.287799999, 572260.4786 3622409.0483999997, 572286.0181 3622391.4811000004, 572324.4790000003 3622348.612400001, 572401.8037 3622212.0798000004, 572474.3117000004 3622042.489499999, 572548.5162000004 3621977.0516999997, 572592.2566 3621908.8269999996, 572633.0646000002 3621888.837099999, 572759.9907 3621897.504899999, 572775.5866999999 3621854.4333999995, 572760.6985999998 3621811.1458, 572670.5866999999 3621650.3813000005, 572668.3728999998 3621609.7217999995, 572697.8660000004 3621419.4486, 572758.9790000003 3621402.1724999994, 572845.2747999998 3621410.4992999993, 572888.8081999999 3621367.6699, 572965.2766000004 3621335.2675, 573001.1770000001 3621294.9323999994, 573029.7366000004 3621218.955600001, 573068.1179 3621183.7092000004, 573088.4957999997 3621176.2611999996, 573091.2128999997 3621155.963199999, 573122.1290999996 3621102.8718999997, 573140.0082999999 3621090.3205999993, 573150.4156999998 3621059.9240000006, 573140.7006000001 3621006.503900001, 573169.0624000002 3620955.9364, 573174.3848000001 3620925.4876000006, 573207.7822000002 3620880.0571, 573281.6753000002 3620852.7083, 573335.0335999997 3620850.6041, 573403.7856999999 3620828.2958000004, 573478.0928999996 3620750.1677, 573574.9411000004 3620710.315300001, 573714.7712000003 3620696.2300000004, 573760.6153999995 3620681.374399999, 573793.5891000004 3620686.7191000003, 573849.875 3620636.383199999, 573860.2346000001 3620613.5997, 573901.2269000001 3620570.7556999996, 573925.1569999997 3620438.8706, 573938.0093999999 3620421.1908, 573986.5179000003 3620391.1083000004, 574133.8997 3620384.7052999996, 574187.3558 3620369.8936, 574279.4033000004 3620296.9740999993, 574310.5499 3620215.9572, 574311.3217000002 3620121.971000001, 574319.0071 3620114.4231000002, 574321.8285999997 3620078.8784999996, 574450.9254000001 3619823.3905999996, 574474.2874999996 3619762.6117000002, 574482.4108999996 3619701.7039, 574477.8823999995 3619635.6308999993, 574450.7328000003 3619538.892999999, 574435.5696999999 3619528.602, 574428.2759999996 3619490.4464, 574426.2966999998 3619421.8354, 574439.2211999996 3619394.0088, 574467.3409000002 3619371.3812000006, 574530.9560000002 3619359.1973, 574579.3764000004 3619339.2796, 574612.7163000004 3619298.9087000005, 574625.6730000004 3619268.5327000003, 574643.5763999997 3619253.4416000005, 574656.5905999998 3619215.4385, 574616.5162000004 3619146.519099999, 574617.0747999996 3619077.956599999, 574643.3129000003 3618976.556399999, 574658.6990999999 3618958.8965000007, 574750.1465999996 3618957.1152999997, 574788.6124999998 3618914.2557999995, 574801.6151999999 3618876.2455, 574847.5014000004 3618856.3172999993, 574883.0813999996 3618854.057499999, 574993.3272000002 3618730.4975000005, 575009.3716000002 3618631.556500001, 575057.9369999999 3618593.8665999994, 575058.4535999997 3618532.901799999, 574995.4123999998 3618476.4978, 574985.4304999998 3618453.562000001, 574995.7632999998 3618433.3147, 575029.0564000001 3618400.5723, 575029.2352999998 3618377.713199999, 575011.7121000001 3618347.0929000005, 575012.1904999996 3618288.6702999994, 575020.0246000001 3618263.333799999, 575050.8519000001 3618220.4027999993, 575061.2807999998 3618187.4658000004, 575099.8406999996 3618131.902899999, 575102.6139000002 3618103.9857, 575110.2698999997 3618098.9659, 575110.4807000002 3618073.5571, 575095.4689999996 3618045.4834000003, 575095.8262999998 3618002.3149999995, 575131.6075999998 3617974.669399999, 575164.9987000003 3617929.2229999993, 575233.7882000003 3617904.3773, 575267.0393000003 3617876.7129999995, 575269.7427000003 3617856.4229000006, 575254.7504000003 3617825.8138999995, 575252.5458000004 3617785.1538999993, 575267.9732999997 3617762.4177, 575268.1458999999 3617742.101, 575298.7516999999 3617727.1072000004, 575301.4298 3617709.3445999995, 575324.3476 3617701.912900001, 575357.7275 3617659.0095000006, 575365.8705000002 3617595.5747999996, 575404.3192999996 3617552.710000001, 575462.9312000005 3617530.316299999, 575475.7133999998 3617520.2654999997, 575445.9401000002 3617433.6531000007, 575446.2734000003 3617393.0270000007, 575469.4932000004 3617350.0320999995, 575457.1789999995 3617301.6678, 575439.5465000002 3617283.7364000008, 575391.2679000003 3617285.8758000005, 575376.1593000004 3617270.5209999997, 575376.4477000004 3617234.9574999996, 575394.5608999999 3617194.4736, 575473.9607999995 3617113.8411, 575494.5542000001 3617080.9964000005, 575494.8299000002 3617047.9680000003, 575462.2741 3616991.8225, 575457.5779999997 3616943.5160000008, 575498.7208000002 3616882.874399999, 575547.1743999999 3616860.4188, 575674.3649000004 3616836.064099999, 575717.9245999996 3616790.696799999, 575715.7408999996 3616747.4944, 575701.0180000002 3616683.8784999996, 575614.0193999996 3616452.010399999, 575563.7637999998 3616385.5600000005, 575475.2653000001 3616336.573000001, 575465.2560999999 3616318.7068000007, 575468.1595000001 3616272.9932000004, 575542.3442000002 3616210.1116000004, 575565.8365000002 3616134.1032999996, 575587.0747999996 3616019.969900001, 575595.6244999999 3615908.2751, 575603.2823999999 3615903.2631, 575603.4106999999 3615888.0237000007, 575613.6898999996 3615872.8542, 575619.2723000003 3615811.9428000003, 575627.0199999996 3615796.7687999997, 575646.0684000002 3615641.9681, 575661.5834999997 3615609.0703999996, 575667.1664000005 3615548.1591, 575682.7659 3615502.5569, 575693.4693999998 3615436.606899999, 575729.4285000004 3615388.6466000006, 575783.0428999998 3615356.0613, 575806.1723999996 3615323.2292, 575804.0722000003 3615269.8648000006, 575773.6316999998 3615264.5330999997, 575745.9797 3615228.7496000007, 575741.2832000004 3615182.992900001, 575766.8930000002 3615157.785, 575787.5428999998 3615117.3212, 575767.9735000003 3615025.7229999993, 575752.125 3614789.355900001, 575765.1229999997 3614753.903999999, 575806.1864 3614703.4404000007, 575903.4851000002 3614607.7070000004, 575959.6298000002 3614575.1417999994, 576028.3611000003 3614557.928099999, 576074.9417000003 3614454.1592999995, 576098.1518999999 3614411.1732, 576138.9212999996 3614396.266899999, 576215.9733999996 3614292.7613999993, 576242.1041000001 3614204.069700001, 576290.9424 3614133.334899999, 576336.8674999997 3614108.3136, 576407.9016000004 3614119.043400001, 576436.2027000003 3614076.1043999996, 576434.8191 3613933.853599999, 576447.6912000002 3613913.6272, 576502.4455000004 3613741.3564999998, 576548.8925000001 3613652.8290999997, 576710.0093 3613519.523, 576799.3097999999 3613471.9849999994, 576895.9066000003 3613462.634299999, 576918.8881000001 3613447.564200001, 576924.1991999997 3613419.6819, 576936.9819 3613409.6253999993, 576944.7922999999 3613386.8253000006, 576980.5629000003 3613361.721000001, 577033.8082999997 3613372.3102, 577066.8969999999 3613364.9608999994, 577118.068 3613319.658399999, 577204.6316 3613294.9630999994, 577306.3531 3613280.5637999997, 577364.9237000002 3613263.2728000004, 577405.9369000001 3613217.8706, 577541.0719999997 3613155.4847, 577576.6678999998 3613150.6917000003, 577734.7093000002 3613083.401799999, 577841.5505999997 3613063.9553999994, 577900.2427000003 3613031.4208000004, 577984.2662000004 3613006.7123000007, 578068.6211999999 3612941.3564, 578160.4595999997 3612893.8355, 578227.2006999999 3612808.0320999995, 578345.0031000003 3612692.1500000004, 578378.3687000005 3612649.2413999997, 578383.6182000004 3612628.9573999997, 578411.8870999999 3612588.5513000004, 578430.2082000002 3612522.663899999, 578445.6783999996 3612494.8476, 578478.8712999998 3612474.7984999996, 578545.0321000004 3612460.0944, 578573.2419999996 3612427.3011000007, 578596.7681999998 3612346.2147000004, 578624.9786 3612313.421599999, 578650.8636999996 3612255.2071, 578714.8148999996 3612199.858100001, 578725.2227999996 3612169.467, 578750.8892999999 3612136.654100001, 578791.6597999996 3612121.7435, 578883.0091000004 3612132.6514, 578936.5522999996 3612110.229800001, 579071.1847999999 3612108.7994, 579114.5691999998 3612083.7480999995, 579269.6656999998 3612064.6926000006, 579302.9627999999 3612031.9492000006, 579380.7189999996 3612008.9540999997, 579479.0724 3612011.2682000007, 579431.5049 3611953.7707, 579365.0266000004 3611899.397, 579330.0033 3611792.3099000007, 579270.1544000003 3611667.685900001, 579282.8570999997 3611578.6805000007, 579371.6498999996 3611531.9146999996, 579446.4910000004 3611486.0066, 579488.0356000001 3611456.8477, 579536.3735999996 3611447.0855, 579681.2051999997 3611440.659499999, 579736.7472000001 3611481.762, 579790.0739000002 3611484.7239999995, 579859.5214 3611378.619999999, 579867.7878999999 3611299.9344999995, 579891.1172000002 3611244.245100001, 579893.9206999997 3611211.2664, 579940.0883 3611155.7380999997, 579960.8119000001 3611107.6555000003, 579994.0267000003 3611085.0615, 580091.6589000002 3610948.704500001, 580173.0869000005 3610931.583799999, 580231.9787999997 3610873.6536, 580313.6061000004 3610831.139799999, 580364.9358999999 3610768.0495999996, 580413.926 3610679.545, 580498.1091 3610634.5108000003, 580577.3565999996 3610574.1970000006, 580600.8227000004 3610500.7273999993, 580603.9494000003 3610429.6358000003, 580703.1564999996 3610412.6630000006, 580723.7225000001 3610382.3636000007, 580721.4571000002 3610349.3071999997, 580708.8866999997 3610331.4224999994, 580704.0882000001 3610298.3603000008, 580745.0975000001 3610252.978700001, 580811.2435999997 3610240.8242000006, 580829.1540000001 3610225.7216999996, 580834.3762999997 3610207.9957999997, 580804.2150999997 3610169.642999999, 580796.9349999996 3610126.4053000007, 580809.8762999997 3610098.5571999997, 580845.8021 3610053.1421000008, 580871.4128999999 3610027.9394000005, 580957.9839000003 3610003.2536999993, 580991.1796000004 3609980.6701999996, 581096.3589000003 3609854.5096000005, 581147.3344999999 3609834.6138000004, 581195.5932 3609835.0067, 581231.3770000003 3609807.3598999996, 581234.2888000002 3609761.6624999996, 581224.3591999998 3609733.6433000006, 581222.2067999998 3609685.3620999996, 581240.1187000005 3609670.2676, 581240.8969 3609576.2891000006, 581281.8575999998 3609535.9942000005, 581381.4003999997 3609478.365, 581422.0635000002 3609476.161800001, 581464.9692000002 3609509.535599999, 581535.9382999996 3609527.8987000007, 581571.6201999998 3609512.950099999, 581638.5086000003 3609409.3573000003, 581687.1355999997 3609366.5768, 581768.5899999999 3609344.3839, 581852.8531 3609291.726399999, 581898.5959000001 3609289.5742000006, 581928.9227 3609307.6063, 581964.4599000001 3609310.4334999993, 582005.3745999997 3609277.7465000004, 582031.3454999998 3609209.363500001, 582044.3499999996 3609171.3695, 582090.4069999997 3609131.112400001, 582139.1589000002 3609070.5374, 582169.7163000004 3609060.6262999997, 582203.2862999998 3608994.8709999993, 582336.0865000002 3608907.0517999995, 582384.6792000001 3608866.8094999995, 582415.2648 3608854.356899999, 582443.4787999997 3608821.5742000006, 582477.2553000003 3608730.3960999995, 582496.4631000003 3608555.290100001, 582509.3502000002 3608532.5361, 582542.5965 3608504.858100001, 582624.0598999998 3608482.6719000004, 582670.0171999997 3608455.107000001, 582877.5636999998 3608235.8136, 582964.3505999995 3608183.1787, 582972.2654999997 3608147.6860000007, 582990.1913999999 3608130.052100001, 583048.7319 3608115.2841, 583092.1672 3608085.1722999997, 583107.6383999996 3608057.348099999, 583107.9346000003 3608021.7994, 583080.3931 3607973.3061999995, 583078.3335999995 3607914.862400001, 583098.8844999997 3607887.0878, 583172.892 3607844.511, 583180.7018999998 3607821.7228999995, 583208.915 3607788.934699999, 583285.3300999999 3607761.6118, 583326.2577999998 3607726.387599999, 583397.6127000004 3607699.0308, 583441.0597000001 3607666.3706, 583495.1552999998 3607575.365700001, 583536.2335000001 3607522.3532, 583562.1365999999 3607461.601, 583659.4091999996 3607368.4234999996, 583718.5820000004 3607277.4549000002, 583747.0203999998 3607216.7316999994, 583788.9357000003 3607062.1218999997, 583799.1748000002 3607052.045, 583817.4480999997 3606991.2293999996, 583928.2884999998 3606796.5481000002, 583946.6759000001 3606723.0430999994, 583975.1902999999 3606652.1436))"],
                "P": [36,0,0,0],
                "I": [0,0,16,0],
                "E": [0,0,0,6],
                "Unknown": [1,1,0,0],
                "ALI": [1,0,1,1],
                "Class_Wt": ["P","U","I","E"],
                "Class_OR": ["P","U","I","I"]
            }
        )

        df2["geometry"] = gpd.GeoSeries.from_wkt(df2["geometry"])

        gdf2=gpd.GeoDataFrame(df2,geometry="geometry")


        x3=flow_classification.flow_classification(GDB_Path= r"tests/ADEQ_FlowRegimes_Test2\Flow_Regimes.gdb", Obs_Layer='FlowRegime_Observations', SHP_Layer='WBID_FlwRgme_Designations',Unique_ID_Shp='WBID', Geometry_Column='geometry', Unique_ID_Obs='WBID', Flow_Regime_Column='Flow_Regime', Priority_Column='Priority',Case=False, At_Least_Intermittent_Input_List=['At Least Intermittent', 'ALI', 'At Least I'], At_Least_Intermittent_Include=False, At_Least_Intermittent_Override=True, Override_Flag=True)
        for i in range(len(x3)):
            for j in range(len(x3['WBID'])):
                self.assertEqual( x3.iloc[i][j], gdf2.iloc[i][j])
        print("done")

unittest.main()
